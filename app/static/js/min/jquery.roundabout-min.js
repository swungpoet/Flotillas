!function($){"use strict";var t,a,n;$.extend({roundaboutShapes:{def:"lazySusan",lazySusan:function(t,a,n){return{x:Math.sin(t+a),y:Math.sin(t+3*Math.PI/2+a)/8*n,z:(Math.cos(t+a)+1)/2,scale:Math.sin(t+Math.PI/2+a)/2+.5}}}}),t={bearing:0,tilt:0,minZ:100,maxZ:280,minOpacity:.3,maxOpacity:1.1,minScale:.4,maxScale:.6,duration:300,btnNext:null,btnNextCallback:function(){},btnPrev:null,btnPrevCallback:function(){},btnToggleAutoplay:null,btnStartAutoplay:null,btnStopAutoplay:null,easing:"swing",clickToFocus:!0,clickToFocusCallback:function(){},focusBearing:0,shape:"lazySusan",debug:!1,childSelector:"li",startingChild:null,reflect:!1,floatComparisonThreshold:.001,autoplay:!1,autoplayDuration:1e3,autoplayPauseOnHover:!1,autoplayCallback:function(){},autoplayInitialDelay:0,enableDrag:!1,dropDuration:600,dropEasing:"swing",dropAnimateTo:"nearest",dropCallback:function(){},dragAxis:"x",dragFactor:4,triggerFocusEvents:!0,triggerBlurEvents:!0,responsive:!1},a={autoplayInterval:null,autoplayIsRunning:!1,autoplayStartTimeout:null,animating:!1,childInFocus:-1,touchMoveStartPosition:null,stopAnimation:!1,lastAnimationStep:!1},n={init:function(i,o,e){var r,u=(new Date).getTime();return i="object"==typeof i?i:{},o=$.isFunction(o)?o:function(){},o=$.isFunction(i)?i:o,r=$.extend({},t,i,a),this.each(function(){var t=$(this),a=t.children(r.childSelector).length,i=360/a,u=r.startingChild&&r.startingChild>a-1?a-1:r.startingChild,l=null===r.startingChild?r.bearing:360-u*i,s="static"!==t.css("position")?t.css("position"):"relative";t.css({padding:0,position:s}).addClass("roundabout-holder").data("roundabout",$.extend({},r,{startingChild:u,bearing:l,oppositeOfFocusBearing:n.normalize.apply(null,[r.focusBearing-180]),dragBearing:l,period:i})),e?t.unbind(".roundabout").children(r.childSelector).unbind(".roundabout"):r.responsive&&$(window).bind("resize",function(){n.stopAutoplay.apply(t),n.relayoutChildren.apply(t)}),r.clickToFocus&&t.children(r.childSelector).each(function(a){$(this).bind("click.roundabout",function(){var i=n.getPlacement.apply(t,[a]);return n.isInFocus.apply(t,[i])?void 0:(n.stopAnimation.apply($(this)),t.data("roundabout").animating||n.animateBearingToFocus.apply(t,[i,t.data("roundabout").clickToFocusCallback]),!1)})}),r.btnNext&&$(r.btnNext).bind("click.roundabout",function(){return t.data("roundabout").animating||n.animateToNextChild.apply(t,[t.data("roundabout").btnNextCallback]),!1}),r.btnPrev&&$(r.btnPrev).bind("click.roundabout",function(){return n.animateToPreviousChild.apply(t,[t.data("roundabout").btnPrevCallback]),!1}),r.btnToggleAutoplay&&$(r.btnToggleAutoplay).bind("click.roundabout",function(){return n.toggleAutoplay.apply(t),!1}),r.btnStartAutoplay&&$(r.btnStartAutoplay).bind("click.roundabout",function(){return n.startAutoplay.apply(t),!1}),r.btnStopAutoplay&&$(r.btnStopAutoplay).bind("click.roundabout",function(){return n.stopAutoplay.apply(t),!1}),r.autoplayPauseOnHover&&t.bind("mouseenter.roundabout.autoplay",function(){n.stopAutoplay.apply(t,[!0])}).bind("mouseleave.roundabout.autoplay",function(){n.startAutoplay.apply(t)}),r.enableDrag&&($.isFunction(t.drag)?$.isFunction(t.drop)?t.drag(function(a,i){var o=t.data("roundabout"),e="x"===o.dragAxis.toLowerCase()?"deltaX":"deltaY";n.stopAnimation.apply(t),n.setBearing.apply(t,[o.dragBearing+i[e]/o.dragFactor])}).drop(function(a){var i=t.data("roundabout"),o=n.getAnimateToMethod(i.dropAnimateTo);n.allowAnimation.apply(t),n[o].apply(t,[i.dropDuration,i.dropEasing,i.dropCallback]),i.dragBearing=i.period*n.getNearestChild.apply(t)}):r.debug&&alert("You do not have the drop plugin loaded."):r.debug&&alert("You do not have the drag plugin loaded."),t.each(function(){var t=$(this).get(0),a=$(this).data("roundabout"),i="x"===a.dragAxis.toLowerCase()?"pageX":"pageY",o=n.getAnimateToMethod(a.dropAnimateTo);t.addEventListener&&(t.addEventListener("touchstart",function(t){a.touchMoveStartPosition=t.touches[0][i]},!1),t.addEventListener("touchmove",function(t){var o=(t.touches[0][i]-a.touchMoveStartPosition)/a.dragFactor;t.preventDefault(),n.stopAnimation.apply($(this)),n.setBearing.apply($(this),[a.dragBearing+o])},!1),t.addEventListener("touchend",function(t){t.preventDefault(),n.allowAnimation.apply($(this)),o=n.getAnimateToMethod(a.dropAnimateTo),n[o].apply($(this),[a.dropDuration,a.dropEasing,a.dropCallback]),a.dragBearing=a.period*n.getNearestChild.apply($(this))},!1))})),n.initChildren.apply(t,[o,e])})},initChildren:function(t,a){var i=$(this),o=i.data("roundabout");return t=t||function(){},i.children(o.childSelector).each(function(t){var o,e,r,u=n.getPlacement.apply(i,[t]);a&&$(this).data("roundabout")&&(o=$(this).data("roundabout").startWidth,e=$(this).data("roundabout").startHeight,r=$(this).data("roundabout").startFontSize),$(this).addClass("roundabout-moveable-item").css("position","absolute"),$(this).data("roundabout",{startWidth:o||$(this).width(),startHeight:e||$(this).height(),startFontSize:r||parseInt($(this).css("font-size"),10),degrees:u,backDegrees:n.normalize.apply(null,[u-180]),childNumber:t,currentScale:1,parent:i})}),n.updateChildren.apply(i),o.autoplay&&(o.autoplayStartTimeout=setTimeout(function(){n.startAutoplay.apply(i)},o.autoplayInitialDelay)),i.trigger("ready"),t.apply(i),i},updateChildren:function(){return this.each(function(){var t=$(this),a=t.data("roundabout"),i=-1,o={bearing:a.bearing,tilt:a.tilt,stage:{width:Math.floor(.9*$(this).width()),height:Math.floor(.9*$(this).height())},animating:a.animating,inFocus:a.childInFocus,focusBearingRadian:n.degToRad.apply(null,[a.focusBearing]),shape:$.roundaboutShapes[a.shape]||$.roundaboutShapes[$.roundaboutShapes.def]};o.midStage={width:o.stage.width/2,height:o.stage.height/2},o.nudge={width:o.midStage.width+.05*o.stage.width,height:o.midStage.height+.05*o.stage.height},o.zValues={min:a.minZ,max:a.maxZ,diff:a.maxZ-a.minZ},o.opacity={min:a.minOpacity,max:a.maxOpacity,diff:a.maxOpacity-a.minOpacity},o.scale={min:a.minScale,max:a.maxScale,diff:a.maxScale-a.minScale},t.children(a.childSelector).each(function(e){!n.updateChild.apply(t,[$(this),o,e,function(){$(this).trigger("ready")}])||o.animating&&!a.lastAnimationStep?$(this).removeClass("roundabout-in-focus"):(i=e,$(this).addClass("roundabout-in-focus"))}),i!==o.inFocus&&(a.triggerBlurEvents&&t.children(a.childSelector).eq(o.inFocus).trigger("blur"),a.childInFocus=i,a.triggerFocusEvents&&-1!==i&&t.children(a.childSelector).eq(i).trigger("focus")),t.trigger("childrenUpdated")})},updateChild:function(t,a,i,o){var e,r=this,u=$(t),l=u.data("roundabout"),s=[],d=n.degToRad.apply(null,[360-l.degrees+a.bearing]);return o=o||function(){},d=n.normalizeRad.apply(null,[d]),e=a.shape(d,a.focusBearingRadian,a.tilt),e.scale=e.scale>1?1:e.scale,e.adjustedScale=(a.scale.min+a.scale.diff*e.scale).toFixed(4),e.width=(e.adjustedScale*l.startWidth).toFixed(4),e.height=(e.adjustedScale*l.startHeight).toFixed(4),u.css({left:(e.x*a.midStage.width+a.nudge.width-e.width/2).toFixed(0)+"px",top:(e.y*a.midStage.height+a.nudge.height-e.height/2).toFixed(0)+"px",width:e.width+"px",height:e.height+"px",opacity:(a.opacity.min+a.opacity.diff*e.scale).toFixed(2),zIndex:Math.round(a.zValues.min+a.zValues.diff*e.z),fontSize:(e.adjustedScale*l.startFontSize).toFixed(1)+"px"}),l.currentScale=e.adjustedScale,r.data("roundabout").debug&&(s.push('<div style="font-weight: normal; font-size: 10px; padding: 2px; width: '+u.css("width")+'; background-color: #ffc;">'),s.push('<strong style="font-size: 12px; white-space: nowrap;">Child '+i+"</strong><br />"),s.push("<strong>left:</strong> "+u.css("left")+"<br />"),s.push("<strong>top:</strong> "+u.css("top")+"<br />"),s.push("<strong>width:</strong> "+u.css("width")+"<br />"),s.push("<strong>opacity:</strong> "+u.css("opacity")+"<br />"),s.push("<strong>height:</strong> "+u.css("height")+"<br />"),s.push("<strong>z-index:</strong> "+u.css("z-index")+"<br />"),s.push("<strong>font-size:</strong> "+u.css("font-size")+"<br />"),s.push("<strong>scale:</strong> "+u.data("roundabout").currentScale),s.push("</div>"),u.html(s.join(""))),u.trigger("reposition"),o.apply(r),n.isInFocus.apply(r,[l.degrees])},setBearing:function(t,a){return a=a||function(){},t=n.normalize.apply(null,[t]),this.each(function(){var a,i,o,e=$(this),r=e.data("roundabout"),u=r.bearing;r.bearing=t,e.trigger("bearingSet"),n.updateChildren.apply(e),a=Math.abs(u-t),!r.animating||a>180||(a=Math.abs(u-t),e.children(r.childSelector).each(function(a){var i;n.isChildBackDegreesBetween.apply($(this),[t,u])&&(i=u>t?"Clockwise":"Counterclockwise",$(this).trigger("move"+i+"ThroughBack"))}))}),a.apply(this),this},adjustBearing:function(t,a){return a=a||function(){},0===t?this:(this.each(function(){n.setBearing.apply($(this),[$(this).data("roundabout").bearing+t])}),a.apply(this),this)},setTilt:function(t,a){return a=a||function(){},this.each(function(){$(this).data("roundabout").tilt=t,n.updateChildren.apply($(this))}),a.apply(this),this},adjustTilt:function(t,a){return a=a||function(){},this.each(function(){n.setTilt.apply($(this),[$(this).data("roundabout").tilt+t])}),a.apply(this),this},animateToBearing:function(t,a,i,o,e){var r=(new Date).getTime();return e=e||function(){},$.isFunction(o)?(e=o,o=null):$.isFunction(i)?(e=i,i=null):$.isFunction(a)&&(e=a,a=null),this.each(function(){var u,l,s,d=$(this),p=d.data("roundabout"),c=a?a:p.duration,h=i?i:p.easing||"swing";return o||(o={timerStart:r,start:p.bearing,totalTime:c}),u=r-o.timerStart,p.stopAnimation?(n.allowAnimation.apply(d),void(p.animating=!1)):void(c>u?(p.animating||d.trigger("animationStart"),p.animating=!0,"string"==typeof $.easing.def?(l=$.easing[h]||$.easing[$.easing.def],s=l(null,u,o.start,t-o.start,o.totalTime)):s=$.easing[h](u/o.totalTime,u,o.start,t-o.start,o.totalTime),n.compareVersions.apply(null,[$().jquery,"1.7.2"])>=0&&(s=o.start+(t-o.start)*s),s=n.normalize.apply(null,[s]),p.dragBearing=s,n.setBearing.apply(d,[s,function(){setTimeout(function(){n.animateToBearing.apply(d,[t,c,h,o,e])},0)}])):(p.lastAnimationStep=!0,t=n.normalize.apply(null,[t]),n.setBearing.apply(d,[t,function(){d.trigger("animationEnd")}]),p.animating=!1,p.lastAnimationStep=!1,p.dragBearing=t,e.apply(d)))}),this},animateToNearbyChild:function(t,a){var i=t[0],o=t[1],e=t[2]||function(){};return $.isFunction(o)?(e=o,o=null):$.isFunction(i)&&(e=i,i=null),this.each(function(){var t,r,u=$(this),l=u.data("roundabout"),s=l.reflect?l.bearing:l.bearing%360,d=u.children(l.childSelector).length;if(!l.animating)if(l.reflect&&"previous"===a||!l.reflect&&"next"===a){for(s=Math.abs(s)<l.floatComparisonThreshold?360:s,t=0;d>t;t+=1)if(r={lower:l.period*t,upper:l.period*(t+1)},r.upper=t===d-1?360:r.upper,s<=Math.ceil(r.upper)&&s>=Math.floor(r.lower)){2===d&&360===s?n.animateToDelta.apply(u,[-180,i,o,e]):n.animateBearingToFocus.apply(u,[r.lower,i,o,e]);break}}else for(s=Math.abs(s)<l.floatComparisonThreshold||360-Math.abs(s)<l.floatComparisonThreshold?0:s,t=d-1;t>=0;t-=1)if(r={lower:l.period*t,upper:l.period*(t+1)},r.upper=t===d-1?360:r.upper,s>=Math.floor(r.lower)&&s<Math.ceil(r.upper)){2===d&&360===s?n.animateToDelta.apply(u,[180,i,o,e]):n.animateBearingToFocus.apply(u,[r.upper,i,o,e]);break}})},animateToNearestChild:function(t,a,i){return i=i||function(){},$.isFunction(a)?(i=a,a=null):$.isFunction(t)&&(i=t,t=null),this.each(function(){var o=n.getNearestChild.apply($(this));n.animateToChild.apply($(this),[o,t,a,i])})},animateToChild:function(t,a,i,o){return o=o||function(){},$.isFunction(i)?(o=i,i=null):$.isFunction(a)&&(o=a,a=null),this.each(function(){var e,r=$(this),u=r.data("roundabout");u.childInFocus===t||u.animating||(e=r.children(u.childSelector).eq(t),n.animateBearingToFocus.apply(r,[e.data("roundabout").degrees,a,i,o]))})},animateToNextChild:function(t,a,i){return n.animateToNearbyChild.apply(this,[arguments,"next"])},animateToPreviousChild:function(t,a,i){return n.animateToNearbyChild.apply(this,[arguments,"previous"])},animateToDelta:function(t,a,i,o){return o=o||function(){},$.isFunction(i)?(o=i,i=null):$.isFunction(a)&&(o=a,a=null),this.each(function(){var e=$(this).data("roundabout").bearing+t;n.animateToBearing.apply($(this),[e,a,i,o])})},animateBearingToFocus:function(t,a,i,o){return o=o||function(){},$.isFunction(i)?(o=i,i=null):$.isFunction(a)&&(o=a,a=null),this.each(function(){var e=$(this).data("roundabout").bearing-t;e=Math.abs(360-e)<Math.abs(e)?360-e:-e,e=e>180?-(360-e):e,0!==e&&n.animateToDelta.apply($(this),[e,a,i,o])})},stopAnimation:function(){return this.each(function(){$(this).data("roundabout").stopAnimation=!0})},allowAnimation:function(){return this.each(function(){$(this).data("roundabout").stopAnimation=!1})},startAutoplay:function(t){return this.each(function(){var a=$(this),i=a.data("roundabout");t=t||i.autoplayCallback||function(){},clearInterval(i.autoplayInterval),i.autoplayInterval=setInterval(function(){n.animateToNextChild.apply(a,[t])},i.autoplayDuration),i.autoplayIsRunning=!0,a.trigger("autoplayStart")})},stopAutoplay:function(t){return this.each(function(){clearInterval($(this).data("roundabout").autoplayInterval),$(this).data("roundabout").autoplayInterval=null,$(this).data("roundabout").autoplayIsRunning=!1,t||$(this).unbind(".autoplay"),$(this).trigger("autoplayStop")})},toggleAutoplay:function(t){return this.each(function(){var a=$(this),i=a.data("roundabout");t=t||i.autoplayCallback||function(){},n.isAutoplaying.apply($(this))?n.stopAutoplay.apply($(this),[t]):n.startAutoplay.apply($(this),[t])})},isAutoplaying:function(){return this.data("roundabout").autoplayIsRunning},changeAutoplayDuration:function(t){return this.each(function(){var a=$(this),i=a.data("roundabout");i.autoplayDuration=t,n.isAutoplaying.apply(a)&&(n.stopAutoplay.apply(a),setTimeout(function(){n.startAutoplay.apply(a)},10))})},normalize:function(t){var a=t%360;return 0>a?360+a:a},normalizeRad:function(t){for(;0>t;)t+=2*Math.PI;for(;t>2*Math.PI;)t-=2*Math.PI;return t},isChildBackDegreesBetween:function(t,a){var n=$(this).data("roundabout").backDegrees;return t>a?n>=a&&t>n:a>n&&n>=t},getAnimateToMethod:function(t){return t=t.toLowerCase(),"next"===t?"animateToNextChild":"previous"===t?"animateToPreviousChild":"animateToNearestChild"},relayoutChildren:function(){return this.each(function(){var t=$(this),a=$.extend({},t.data("roundabout"));a.startingChild=t.data("roundabout").childInFocus,n.init.apply(t,[a,null,!0])})},getNearestChild:function(){var t=$(this),a=t.data("roundabout"),n=t.children(a.childSelector).length;return a.reflect?Math.round(a.bearing/a.period)%n:(n-Math.round(a.bearing/a.period)%n)%n},degToRad:function(t){return n.normalize.apply(null,[t])*Math.PI/180},getPlacement:function(t){var a=this.data("roundabout");return a.reflect?a.period*t:360-a.period*t},isInFocus:function(t){var a,i=this,o=i.data("roundabout"),e=n.normalize.apply(null,[o.bearing]);return t=n.normalize.apply(null,[t]),a=Math.abs(e-t),a<=o.floatComparisonThreshold||a>=360-o.floatComparisonThreshold},getChildInFocus:function(){var t=$(this).data("roundabout");return t.childInFocus>-1?t.childInFocus:!1},compareVersions:function(t,a){var n,i=t.split(/\./i),o=a.split(/\./i),e=i.length>o.length?i.length:o.length;for(n=0;e>=n;n++){if(i[n]&&!o[n]&&0!==parseInt(i[n],10))return 1;if(o[n]&&!i[n]&&0!==parseInt(o[n],10))return-1;if(i[n]!==o[n]&&i[n]&&o[n])return parseInt(i[n],10)>parseInt(o[n],10)?1:-1}return 0}},$.fn.roundabout=function(t){return n[t]?n[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"==typeof t||$.isFunction(t)||!t?n.init.apply(this,arguments):void $.error("Method "+t+" does not exist for jQuery.roundabout.")}}(jQuery);